{% extends 'base.html' %}
{% load static %}
{% block extra_head %}
  <meta name="description" content="Contactez ANNOOR — devis, étude, assistance technique.">
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"ContactPage",
    "name":"Contact — ANNOOR",
    "description":"Demande de devis, étude technique, assistance.",
    "url":"{{ request.build_absolute_uri|default:'' }}",
    "publisher":{"@type":"Organization","name":"ANNOOR"}
  }
  </script>
{% endblock %}

{% block content %}

<!-- HERO -->
<section class="relative">
  <div class="absolute inset-0 bg-gradient-to-br from-slate-900 to-slate-800"></div>
  <div class="relative max-w-6xl mx-auto px-4 py-16 text-white">
    <nav class="text-xs/relaxed opacity-80 mb-3">
      <a href="/" class="hover:underline">Accueil</a> / <span>Contact</span>
    </nav>
    <h1 class="text-3xl md:text-5xl font-bold tracking-tight">Parlons de votre projet</h1>
    <p class="mt-3 max-w-2xl text-white/90">Dites-nous votre besoin, vos délais et vos contraintes. Nous revenons vers vous rapidement.</p>
  </div>
</section>

<!-- FLASH MESSAGES -->
{% if messages %}
  <div class="max-w-2xl mx-auto px-4 mt-6">
    {% for m in messages %}
      <div class="mb-3 rounded-lg p-3 text-sm border
                  {% if m.tags == 'success' %}bg-green-50 text-green-800 border-green-200{% else %}bg-red-50 text-red-800 border-red-200{% endif %}">
        {{ m }}
      </div>
    {% endfor %}
  </div>
{% endif %}

<section class="max-w-6xl mx-auto px-4 py-10 grid md:grid-cols-2 gap-10">

  <!-- FORM CARD -->
  <div class="rounded-2xl border bg-white p-6 md:p-8 shadow-sm">
    <div class="flex items-start justify-between gap-4">
      <div>
        <h2 class="text-xl font-semibold">Formulaire de contact</h2>
        <p class="text-sm text-slate-600">Les champs marqués * sont obligatoires.</p>
      </div>
      <span class="inline-flex items-center gap-2 text-xs text-slate-500">
        <span class="size-2 rounded-full bg-emerald-500"></span> Réponse sous 24h
      </span>
    </div>

    <!-- résumé erreurs globales -->
    {% if form.errors and not form.non_field_errors %}
      <div class="mt-5 rounded-lg border border-red-200 bg-red-50 p-3 text-sm text-red-800">
        Veuillez corriger les champs surlignés ci-dessous.
      </div>
    {% endif %}
    {% if form.non_field_errors %}
      <div class="mt-5 rounded-lg border border-red-200 bg-red-50 p-3 text-sm text-red-800">
        {{ form.non_field_errors }}
      </div>
    {% endif %}

    <form method="post" class="mt-6 space-y-4"
          novalidate
          onsubmit="this.querySelector('button[type=submit]').classList.add('opacity-70','pointer-events-none')">
      {% csrf_token %}

      <!-- GRID -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <!-- NOM -->
        <div>
          <label for="{{ form.name.id_for_label }}" class="block text-xs uppercase tracking-wide text-slate-600 mb-1">Nom *</label>
          <div class="relative">
            {{ form.name }}
          </div>
          {% for err in form.name.errors %}<p class="mt-1 text-xs text-red-600">{{ err }}</p>{% endfor %}
        </div>

        <!-- EMAIL -->
        <div>
          <label for="{{ form.email.id_for_label }}" class="block text-xs uppercase tracking-wide text-slate-600 mb-1">Email *</label>
          <div class="relative">
            {{ form.email }}
          </div>
          {% for err in form.email.errors %}<p class="mt-1 text-xs text-red-600">{{ err }}</p>{% endfor %}
        </div>

        <!-- TÉLÉPHONE -->
        <div>
          <label for="{{ form.phone.id_for_label }}" class="block text-xs uppercase tracking-wide text-slate-600 mb-1">Téléphone</label>
          <div class="relative">
            {{ form.phone }}
          </div>
          {% for err in form.phone.errors %}<p class="mt-1 text-xs text-red-600">{{ err }}</p>{% endfor %}
        </div>

        <!-- SUJET -->
        <div>
          <label for="{{ form.subject.id_for_label }}" class="block text-xs uppercase tracking-wide text-slate-600 mb-1">Sujet *</label>
          <div class="relative">
            {{ form.subject }}
          </div>
          {% for err in form.subject.errors %}<p class="mt-1 text-xs text-red-600">{{ err }}</p>{% endfor %}
        </div>
      </div>

      <!-- MESSAGE -->
      <div>
        <div class="flex items-center justify-between">
          <label for="{{ form.message.id_for_label }}" class="block text-xs uppercase tracking-wide text-slate-600 mb-1">Message *</label>
          <span class="text-xs text-slate-400">Max 2000 caractères</span>
        </div>
        {{ form.message }}
        {% for err in form.message.errors %}<p class="mt-1 text-xs text-red-600">{{ err }}</p>{% endfor %}
      </div>

      <!-- HONEYPOT -->
      {% if form.hp %}
        <div class="hidden">
          {{ form.hp }}
        </div>
      {% endif %}

      <!-- RGPD / CTA -->
      <div class="mt-6 flex flex-col md:flex-row md:items-center gap-3 md:justify-between">
        <p class="text-xs text-slate-500">En envoyant ce formulaire, vous acceptez notre <a href="#" class="underline">politique de confidentialité</a>.</p>
        <button type="submit"
                class="inline-flex items-center gap-2 px-5 py-2.5 rounded-lg bg-orange-500 text-white hover:bg-orange-600 transition focus:outline-none focus:ring-2 focus:ring-orange-500">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 24 24" fill="currentColor"><path d="M2.01 21 23 12 2.01 3 2 10l15 2-15 2z"/></svg>
          Envoyer
        </button>
      </div>
    </form>
  </div>

  <!-- ASIDE -->
  <aside class="space-y-6">
    <!-- Coordonnées (depuis SiteContact) -->
    <div class="rounded-2xl border bg-white p-6 md:p-8 shadow-sm">
    <h3 class="text-lg font-semibold">Coordonnées</h3>
    <ul class="mt-3 text-sm text-slate-700 space-y-1">
        {% if site_contact.address or site_contact.city or site_contact.country %}
        <li>
            {{ site_contact.address }}{% if site_contact.address %},{% endif %}
            {{ site_contact.city }}{% if site_contact.city and site_contact.country %},{% endif %}
            {{ site_contact.country }}
        </li>
        {% endif %}
        {% if site_contact.phone %}<li>Tél : {{ site_contact.phone }}</li>{% endif %}
        {% if site_contact.email %}<li>Email : <a href="mailto:{{ site_contact.email }}" class="hover:underline">{{ site_contact.email }}</a></li>{% endif %}
        {% if site_contact.whatsapp_url %}
        <li class="pt-2">
            <a href="{{ site_contact.whatsapp_url }}" class="inline-flex items-center gap-2 text-emerald-700 hover:underline" target="_blank" rel="noopener">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 24 24" fill="currentColor">
                <path d="M20 3.5A4.5 4.5 0 0 1 24 8c0 7.732-6.268 14-14 14a13.94 13.94 0 0 1-7-1.88L0 24l3.03-2.94A13.94 13.94 0 0 1 1.88 14C1.88 6.268 8.148 0 15.88 0A4.5 4.5 0 0 1 20 3.5Z"/>
            </svg>
            WhatsApp
            </a>
        </li>
        {% endif %}
    </ul>
    <div class="mt-5 h-px bg-slate-200"></div>
    {% if site_contact.hours %}
        <p class="mt-5 text-sm text-slate-600">Horaires : {{ site_contact.hours }}</p>
    {% endif %}
    </div>

    <!-- Pourquoi nous -->
    <div class="rounded-2xl border bg-white p-6 md:p-8 shadow-sm">
      <h3 class="text-lg font-semibold">Pourquoi ANNOOR ?</h3>
      <ul class="mt-3 text-sm text-slate-700 space-y-2">
        <li>• Expertise industrielle et agro-procédés</li>
        <li>• Mise en service & maintenance</li>
        <li>• Engagement qualité & sécurité</li>
      </ul>
    </div>

    <!-- FAQ courte (pure HTML) -->
    <div class="rounded-2xl border bg-white p-6 md:p-8 shadow-sm">
      <h3 class="text-lg font-semibold">FAQ</h3>
      <div class="mt-3 text-sm text-slate-700">
        <details class="border-b py-2">
          <summary class="cursor-pointer">Quel délai de réponse ?</summary>
          <p class="mt-2 text-slate-600">Sous 24h ouvrées (souvent le jour même).</p>
        </details>
        <details class="border-b py-2">
          <summary class="cursor-pointer">Intervenez-vous hors Niamey ?</summary>
          <p class="mt-2 text-slate-600">Oui, interventions sur l’ensemble du territoire.</p>
        </details>
        <details class="py-2">
          <summary class="cursor-pointer">Proposez-vous la formation ?</summary>
          <p class="mt-2 text-slate-600">Oui, transfert de compétences et O&M fournis.</p>
        </details>
      </div>
    </div>
  </aside>
</section>

{% endblock %}
