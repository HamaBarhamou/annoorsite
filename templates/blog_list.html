{% extends 'base.html' %}
{% block extra_head %}
  <meta name="description" content="Actualités & insights — ANNOOR">
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"Blog",
    "name":"Actualités — ANNOOR"
  }
  </script>
{% endblock %}
{% block content %}

<section class="relative">
  <div class="absolute inset-0 bg-gradient-to-br from-slate-900 to-slate-800"></div>
  <div class="relative max-w-6xl mx-auto px-4 py-16 text-white">
    <nav class="text-xs opacity-80 mb-3"><a href="/" class="hover:underline">Accueil</a> / <span>Actualités</span></nav>
    <h1 class="text-3xl md:text-5xl font-bold tracking-tight">Actualités</h1>
    <p class="mt-3 max-w-2xl text-white/90">Nos mises en service, projets, et points d’expertise.</p>
  </div>
</section>

<div class="max-w-6xl mx-auto px-4 py-12">
  {% if posts %}
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
      {% for post in posts %}
        <a href="{% url 'blog_detail' slug=post.slug %}" class="group rounded-xl overflow-hidden border bg-white hover:shadow transition">
          {% if post.cover %}
            <img src="{{ post.cover.url }}" alt="" class="h-40 w-full object-cover group-hover:scale-[1.02] transition">
          {% endif %}
          <div class="p-5">
            <div class="text-xs text-slate-500">
              {% if post.pub_date %}{{ post.pub_date|date:"d M Y" }}{% endif %}
              {% if not post.published %}<span class="ml-2 px-2 py-0.5 rounded bg-amber-100 text-amber-800">Brouillon</span>{% endif %}
            </div>
            <h2 class="mt-1 text-lg font-semibold group-hover:underline">{{ post.title }}</h2>
            {% if post.body %}
              <p class="mt-2 text-sm text-slate-600 line-clamp-3">{{ post.body|striptags|truncatechars:160 }}</p>
            {% endif %}
          </div>
        </a>
      {% endfor %}
    </div>

    {# Pagination si fournie par la vue #}
    {% if is_paginated or page_obj %}
      <div class="mt-8 flex items-center justify-center gap-2">
        {% if page_obj.has_previous %}
          <a href="?page={{ page_obj.previous_page_number }}" class="px-3 py-1 rounded border hover:bg-slate-50">Préc.</a>
        {% endif %}
        <span class="px-3 py-1 text-sm text-slate-600">Page {{ page_obj.number }} / {{ page_obj.paginator.num_pages }}</span>
        {% if page_obj.has_next %}
          <a href="?page={{ page_obj.next_page_number }}" class="px-3 py-1 rounded border hover:bg-slate-50">Suiv.</a>
        {% endif %}
      </div>
    {% endif %}
  {% else %}
    <div class="rounded-xl border bg-white p-8 text-slate-600">
      Aucun article pour le moment.
    </div>
  {% endif %}
</div>
{% endblock %}
